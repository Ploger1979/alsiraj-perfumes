# دليل استخدام نظام إدارة المنتجات (AlSiraj Perfumes)

هذا الملف يشرح كيفية عمل لوحة التحكم الجديدة لإدارة المنتجات، الأسعار، والأحجام بشكل احترافي.

---

## 1. إضافة منتج جديد (Add Product)

عند إضافة منتج لأول مرة:
1. إذهب إلى صفحة **Dashboard**.
2. اختر تبويب **"إضافة منتج"**.
3. املأ البيانات الأساسية (الاسم، الوصف، الفئة، الجنس، إلخ).
4. **الصور:** ارفع الصورة الرئيسية للمنتج.
5. **الأحجام والأسعار (Size Manager):**
   - ستجد قسماً خاصاً لإدارة الأحجام.
   - بشكل افتراضي يوجد حجم 100ml.
   - يمكنك تعديل سعره، أو حذفه، أو إضافة أحجام أخرى (مثل 50ml, Gift Set).
   - **هام:** السعر الذي تكتبه هنا هو الذي سيظهر للعميل (بدون أي معادلات حسابية).
6. اضغط **"حفظ المنتج"**.

---

## 2. إضافة حجم جديد لمنتج موجود (Smart Merge)

إذا كان لديك منتج (مثلاً "Good Night") وتريد إضافة حجم 50ml له:
**لا تحتاج للذهاب للتعديل، يمكنك فعل ذلك من شاشة "إضافة منتج" أيضاً!**

1. في شاشة **"إضافة منتج"**، اكتب **نفس اسم المنتج بالضبط** (مثلاً "Good Night").
2. في قسم الأحجام، أضف الحجم الجديد (50ml) وحدد سعره.
3. **الصور:**
   - إذا رفعت صورة جديدة: سيتم إضافتها إلى "ألبوم صور" المنتج (ستظهر أسهم للتنقل).
   - إذا لم ترفع صورة: سيتم استخدام الصور القديمة.
4. اضغط **"حفظ المنتج"**.
   - **النظام سيكتشف الاسم، وسيقوم بدمج الحجم الجديد مع المنتج القديم تلقائياً.**
   - ستظهر رسالة: *"تم دمج الحجم الجديد مع المنتج الموجود مسبقاً بنجاح!"*

---

## 3. تعديل منتج (Edit Product)

للتعديل على تفاصيل منتج أو حذف أحجام:
1. من قائمة المنتجات (List)، اضغط على زر **"تعديل ✏️"**.
2. ستفتح بيانات المنتج في الأعلى.
3. يمكنك:
   - تغيير الاسم أو الوصف.
   - **إدارة الأحجام:** يمكنك حذف حجم معين، أو تعديل سعره، أو إضافة حجم جديد.
   - **الصور:** رفع صور إضافية للألبوم.
4. اضغط **"تحديث المنتج"**.

---

## 4. المميزات التقنية (للمطورين)

### نظام الأسعار (Manual Pricing)
- تم إلغاء نظام "التسعير الذكي" القديم الذي كان يحسب السعر بناءً على النسبة.
- الآن، السعر المخزن في قاعدة البيانات هو السعر النهائي الذي وضعه الأدمن.

### نظام الدمج (Smart Merge Logic)
- الكود (في `api/admin/add-product`) يبحث عن المنتج بالاسم `Product.findOne({ name: regex })`.
- إذا وجده، يقوم بعمل `Array.push` للأحجام الجديدة.
- يقوم بعمل `images.push` للصور الجديدة (بدون حذف القديمة).

### معرض الصور (Image Gallery)
- النظام يدعم عرض عدة صور للمنتج الواحد.
- عند رفع صورة جديدة لمنتج موجود، تضاف لـ `product.images`.
- في صفحة العرض (`ProductDetails`), تظهر أسهم للتنقل إذا كان `product.images` يحتوي على أكثر من صورة.

---

**حالة النظام الحالية:** ✅ *Stable & Production Ready*
يمكنك البدء في إدخال المنتجات الحقيقية.
